"use strict";(self.webpackChunkims_ui=self.webpackChunkims_ui||[]).push([[333],{2333:(A,l,r)=>{r.r(l),r.d(l,{ScannerComponent:()=>O});var _=r(6814),m=r(2715),u=r(592),c=r(95),d=r(5181),n=r(9468),f=r(4472),p=r(1076);function g(t,s){if(1&t&&(n.TgZ(0,"div",10),n._uU(1),n.qZA()),2&t){const e=n.oxw();n.xp6(1),n.hij(" ",e.error.error.message," ")}}function h(t,s){1&t&&(n.TgZ(0,"div",11),n._uU(1," Scan Success "),n.qZA())}function v(t,s){1&t&&(n.TgZ(0,"p",12),n._uU(1," No Scans To Show. "),n.qZA())}function S(t,s){1&t&&(n.TgZ(0,"div")(1,"h5",13),n._uU(2,"Scanned Items"),n.qZA()())}function T(t,s){1&t&&(n.TgZ(0,"div",3)(1,"h5"),n._uU(2,"Notification Sent!"),n.qZA()())}function Z(t,s){if(1&t&&(n.TgZ(0,"div"),n._uU(1),n.qZA()),2&t){const e=n.oxw().$implicit;n.xp6(1),n.hij(" ",null==e?null:e.message," ")}}function I(t,s){if(1&t&&(n.TgZ(0,"div",12),n.YNc(1,Z,2,1,"div",5),n.qZA()),2&t){const e=n.oxw();n.xp6(1),n.Q6J("ngIf",!e.notification)}}function x(t,s){1&t&&(n.TgZ(0,"div",21),n._uU(1," Available quantity of scanned item is required. "),n.qZA())}function E(t,s){1&t&&(n.TgZ(0,"div",21),n._uU(1," Quantity should be a number. "),n.qZA())}function C(t,s){if(1&t&&(n.TgZ(0,"button",22),n._uU(1,"Send Notification"),n.qZA()),2&t){const e=n.oxw(2);n.Q6J("disabled",e.scanForm.invalid)}}function L(t,s){if(1&t){const e=n.EpF();n.TgZ(0,"div",14)(1,"form",15),n.NdJ("ngSubmit",function(){n.CHM(e);const i=n.oxw();return n.KtG(i.sendNotification(i.scanForm))}),n.TgZ(2,"div",3)(3,"label",16),n._uU(4,"How many items are in stock?"),n.qZA(),n._UZ(5,"input",17),n.YNc(6,x,2,0,"div",18),n.YNc(7,E,2,0,"div",18),n.TgZ(8,"div",19),n.YNc(9,C,2,1,"button",20),n.qZA()()()()}if(2&t){const e=n.oxw();let o,i;n.xp6(1),n.Q6J("formGroup",e.scanForm),n.xp6(5),n.Q6J("ngIf",(null==(o=e.scanForm.get("itemQty"))?null:o.hasError("required"))&&(null==(o=e.scanForm.get("itemQty"))?null:o.touched)),n.xp6(1),n.Q6J("ngIf",(null==(i=e.scanForm.get("itemQty"))?null:i.hasError("itemQty"))&&(null==(i=e.scanForm.get("itemQty"))?null:i.touched)),n.xp6(2),n.Q6J("ngIf",!e.notification)}}let O=(()=>{class t{constructor(e,o,i){this.scannerService=e,this.router=o,this.formBuilder=i,this.itemLocation={scannedList:[]}}ngOnInit(){this.notification=!1,this.scannerOpen=!1,this.getScannedList(),this.openNewScanner(),this.scanForm=this.formBuilder.group({itemQty:new c.NI("",[c.kI.required,c.kI.pattern("^[0-9]*$")])})}onScanSuccess(e,o){console.log("Code matched = "+e+", "+o);let i=new u.M(e,!1);this.scannerService.postScan(i).subscribe(a=>{this.itemLocation=a,this.scanSuccess=!0},a=>{this.error=a}),this.codeScanner.clear(),this.scannerOpen=!1}onScanFailure(e,o){}getScannedList(){this.scannerService.getScannedList().subscribe(e=>{this.itemLocation=e})}openNewScanner(){this.getScannerSize(),this.createScanner()}getScannerSize(){let e=Math.min(window.innerWidth,window.innerHeight);this.qrBoxSize=Math.floor(.7*e)}createScanner(){this.scannerOpen||(this.scanSuccess=!1,this.codeScanner=new m.wF("qr-reader",{fps:10,qrbox:{width:this.qrBoxSize,height:this.qrBoxSize}},!1),this.codeScanner.render((e,o)=>this.onScanSuccess(e,o),(e,o)=>this.onScanFailure(e,o)),this.scannerOpen=!0)}sendNotification(e){let o=new d.x(e.get("itemQty")?.value);this.scannerService.sendLowSupplyNotification(o).subscribe(i=>{console.log("Notification sent successfully. Response:",i),this.notification=!0,setTimeout(()=>{this.router.navigate(["/home"])},1e3)},i=>{console.error("Error sending notification:",i)})}static#n=this.\u0275fac=function(o){return new(o||t)(n.Y36(f.L),n.Y36(p.F0),n.Y36(c.qu))};static#e=this.\u0275cmp=n.Xpm({type:t,selectors:[["app-scanner"]],standalone:!0,features:[n.jDz],decls:12,vars:7,consts:[[1,"container"],["class","mt-3 alert alert-danger col-9","role","alert",4,"ngIf"],["class","mt-3 alert alert-success col-9","role","alert",4,"ngIf"],[1,"row"],["class","col-9",4,"ngIf"],[4,"ngIf"],["class","row",4,"ngIf"],["class","col-9",4,"ngFor","ngForOf"],["class","row col-9",4,"ngIf"],["id","qr-reader"],["role","alert",1,"mt-3","alert","alert-danger","col-9"],["role","alert",1,"mt-3","alert","alert-success","col-9"],[1,"col-9"],[1,"col-12"],[1,"row","col-9"],["nonvalidate","",3,"formGroup","ngSubmit"],["for","itemQty","required","",1,"form-label"],["type","itemQty","formControlName","itemQty",1,"form-control","col-9"],["class","error col-9",4,"ngIf"],[1,"btn","btn-primary","col-4"],["type","submit","class","btn btn-primary col-4",3,"disabled",4,"ngIf"],[1,"error","col-9"],["type","submit",1,"btn","btn-primary","col-4",3,"disabled"]],template:function(o,i){1&o&&(n.TgZ(0,"div",0),n.YNc(1,g,2,1,"div",1),n.YNc(2,h,2,0,"div",2),n.TgZ(3,"div",3),n.YNc(4,v,2,0,"p",4),n.qZA(),n.YNc(5,S,3,0,"div",5),n.YNc(6,T,3,0,"div",6),n.TgZ(7,"div",3),n.YNc(8,I,2,1,"div",7),n.qZA(),n._UZ(9,"p"),n.YNc(10,L,10,4,"div",8),n._UZ(11,"div",9),n.qZA()),2&o&&(n.xp6(1),n.Q6J("ngIf",i.error),n.xp6(1),n.Q6J("ngIf",i.scanSuccess),n.xp6(2),n.Q6J("ngIf",!(null!=i.itemLocation&&i.itemLocation.scannedList)),n.xp6(1),n.Q6J("ngIf",(null==i.itemLocation?null:i.itemLocation.scannedList)&&!i.notification),n.xp6(1),n.Q6J("ngIf",i.notification),n.xp6(2),n.Q6J("ngForOf",null==i.itemLocation?null:i.itemLocation.scannedList),n.xp6(2),n.Q6J("ngIf",!i.notification&&!i.scannerOpen))},dependencies:[c.UX,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,_.O5,_.ax]})}return t})()}}]);