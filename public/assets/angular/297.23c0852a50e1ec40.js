"use strict";(self.webpackChunkims_ui=self.webpackChunkims_ui||[]).push([[297],{6297:(C,l,r)=>{r.r(l),r.d(l,{ScannerComponent:()=>N});var u=r(6814),m=r(2715),d=r(592),c=r(95);class f{constructor(s){this.itemQty=s}}var n=r(9468),p=r(4472),g=r(1076);function h(e,s){if(1&e&&(n.TgZ(0,"div",10),n._uU(1),n.qZA()),2&e){const t=n.oxw();n.xp6(1),n.hij(" ",t.error.error.message," ")}}function S(e,s){1&e&&(n.TgZ(0,"div",11),n._uU(1," Scan Success "),n.qZA())}function v(e,s){1&e&&(n.TgZ(0,"p",12),n._uU(1," No Scans To Show. "),n.qZA())}function _(e,s){1&e&&(n.TgZ(0,"div")(1,"h5",13),n._uU(2,"Scanned Items"),n.qZA()())}function Z(e,s){1&e&&(n.TgZ(0,"div",3)(1,"h5"),n._uU(2,"Notification Sent!"),n.qZA()())}function T(e,s){if(1&e&&(n.TgZ(0,"div"),n._uU(1),n.qZA()),2&e){const t=n.oxw().$implicit;n.xp6(1),n.hij(" ",null==t?null:t.Message," ")}}function x(e,s){if(1&e&&(n.TgZ(0,"div",12),n.YNc(1,T,2,1,"div",5),n.qZA()),2&e){const t=n.oxw();n.xp6(1),n.Q6J("ngIf",!t.notification)}}function Q(e,s){1&e&&(n.TgZ(0,"div",21),n._uU(1," Available quantity of scanned item is required. "),n.qZA())}function b(e,s){1&e&&(n.TgZ(0,"div",21),n._uU(1," Quantity should be a number. "),n.qZA())}function y(e,s){if(1&e&&(n.TgZ(0,"button",22),n._uU(1,"Send Notification"),n.qZA()),2&e){const t=n.oxw(2);n.Q6J("disabled",t.scanForm.invalid)}}function I(e,s){if(1&e){const t=n.EpF();n.TgZ(0,"div",14)(1,"form",15),n.NdJ("ngSubmit",function(){n.CHM(t);const i=n.oxw();return n.KtG(i.sendNotification(i.scanForm))}),n.TgZ(2,"div",3)(3,"label",16),n._uU(4,"How many items are in stock?"),n.qZA(),n._UZ(5,"input",17),n.YNc(6,Q,2,0,"div",18),n.YNc(7,b,2,0,"div",18),n.TgZ(8,"div",19),n.YNc(9,y,2,1,"button",20),n.qZA()()()()}if(2&e){const t=n.oxw();let o,i;n.xp6(1),n.Q6J("formGroup",t.scanForm),n.xp6(5),n.Q6J("ngIf",(null==(o=t.scanForm.get("itemQty"))?null:o.hasError("required"))&&(null==(o=t.scanForm.get("itemQty"))?null:o.touched)),n.xp6(1),n.Q6J("ngIf",(null==(i=t.scanForm.get("itemQty"))?null:i.hasError("itemQty"))&&(null==(i=t.scanForm.get("itemQty"))?null:i.touched)),n.xp6(2),n.Q6J("ngIf",!t.notification)}}let N=(()=>{class e{constructor(t,o,i){this.scannerService=t,this.router=o,this.formBuilder=i,this.transactions={scannedList:[]}}ngOnInit(){this.notification=!1,this.scannerOpen=!1,this.getScannedList(),this.openNewScanner(),this.scanForm=this.formBuilder.group({itemQty:new c.NI("",[c.kI.required,c.kI.pattern("^[0-9]*$")])})}onScanSuccess(t,o){console.log("Code matched = "+t+", "+o);let i=new d.M(t,!1);this.scannerService.postScan(i).subscribe(a=>{this.transactions=a,this.scanSuccess=!0},a=>{this.error=a}),this.codeScanner.clear(),this.scannerOpen=!1}onScanFailure(t,o){}getScannedList(){this.scannerService.getScannedList().subscribe(t=>{this.transactions=t})}openNewScanner(){this.getScannerSize(),this.createScanner()}getScannerSize(){let t=Math.min(window.innerWidth,window.innerHeight);this.qrBoxSize=Math.floor(.7*t)}createScanner(){this.scannerOpen||(this.scanSuccess=!1,this.codeScanner=new m.wF("qr-reader",{fps:10,qrbox:{width:this.qrBoxSize,height:this.qrBoxSize}},!1),this.codeScanner.render((t,o)=>this.onScanSuccess(t,o),(t,o)=>this.onScanFailure(t,o)),this.scannerOpen=!0)}sendNotification(t){let o=new f(t.get("itemQty")?.value);this.scannerService.sendNotification(o).subscribe(i=>{console.log("Notification sent successfully. Response:",i),this.notification=!0,setTimeout(()=>{this.router.navigate(["/home"])},1e3)},i=>{console.error("Error sending notification:",i)})}static#n=this.\u0275fac=function(o){return new(o||e)(n.Y36(p.L),n.Y36(g.F0),n.Y36(c.qu))};static#t=this.\u0275cmp=n.Xpm({type:e,selectors:[["app-scanner"]],standalone:!0,features:[n.jDz],decls:12,vars:7,consts:[[1,"container"],["class","mt-3 alert alert-danger col-9","role","alert",4,"ngIf"],["class","mt-3 alert alert-success col-9","role","alert",4,"ngIf"],[1,"row"],["class","col-9",4,"ngIf"],[4,"ngIf"],["class","row",4,"ngIf"],["class","col-9",4,"ngFor","ngForOf"],["class","row col-9",4,"ngIf"],["id","qr-reader"],["role","alert",1,"mt-3","alert","alert-danger","col-9"],["role","alert",1,"mt-3","alert","alert-success","col-9"],[1,"col-9"],[1,"col-12"],[1,"row","col-9"],["nonvalidate","",3,"formGroup","ngSubmit"],["for","itemQty","required","",1,"form-label"],["type","itemQty","formControlName","itemQty",1,"form-control","col-9"],["class","error col-9",4,"ngIf"],[1,"btn","btn-primary","col-4"],["type","submit","class","btn btn-primary col-4",3,"disabled",4,"ngIf"],[1,"error","col-9"],["type","submit",1,"btn","btn-primary","col-4",3,"disabled"]],template:function(o,i){1&o&&(n.TgZ(0,"div",0),n.YNc(1,h,2,1,"div",1),n.YNc(2,S,2,0,"div",2),n.TgZ(3,"div",3),n.YNc(4,v,2,0,"p",4),n.qZA(),n.YNc(5,_,3,0,"div",5),n.YNc(6,Z,3,0,"div",6),n.TgZ(7,"div",3),n.YNc(8,x,2,1,"div",7),n.qZA(),n._UZ(9,"p"),n.YNc(10,I,10,4,"div",8),n._UZ(11,"div",9),n.qZA()),2&o&&(n.xp6(1),n.Q6J("ngIf",i.error),n.xp6(1),n.Q6J("ngIf",i.scanSuccess),n.xp6(2),n.Q6J("ngIf",!(null!=i.transactions&&i.transactions.scannedList)),n.xp6(1),n.Q6J("ngIf",null==i.transactions?null:i.transactions.scannedList),n.xp6(1),n.Q6J("ngIf",i.notification),n.xp6(2),n.Q6J("ngForOf",null==i.transactions?null:i.transactions.scannedList),n.xp6(2),n.Q6J("ngIf",!i.notification&&!i.scannerOpen))},dependencies:[c.UX,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,u.O5,u.ax]})}return e})()}}]);